import{_ as D,s as S,O as k,k as I,g as C,c as i,a,i as s,F as h,h as y,t as o,x as O,o as d,n as g,A as T,B as A}from"./Bkm6qw8b.js";import{_ as R}from"./DjQry-0W.js";import{u as B}from"./vvOl6aKk.js";import{S as _}from"./9Qm2jZ7z.js";import{u as j}from"./D29843uf.js";import"./BtuP6t-4.js";import"./u26IMBn3.js";import"./B1HDS-e3.js";import"./CGIrALZn.js";const N={class:"content-wrapper"},F={class:"container-xxl flex-grow-1 container-p-y"},Q={key:0,class:"text-center"},V={class:"row invoice-preview"},q={class:"col-xl-9 col-md-8 col-12 mb-md-0 mb-6"},E={class:"card invoice-preview-card p-sm-12 p-6"},L={class:"card-body invoice-preview-header rounded-4 p-6"},M={class:"d-flex justify-content-between flex-xl-row flex-md-column flex-sm-row flex-column text-heading align-items-xl-center align-items-md-start align-items-sm-center flex-wrap gap-6"},U={class:"mb-1"},$={class:"mb-1"},G={class:"mb-0"},W={class:"mb-6"},X={class:"mb-1"},z={class:"card-body py-6 px-0"},H={class:"d-flex justify-content-between flex-wrap gap-6"},J={class:"mb-1"},K={class:"mb-1"},Y={class:"mb-1"},Z={class:"mb-1"},aa={class:"mb-0"},ta={class:"mb-1"},ea={class:"mb-1"},sa={class:"table-responsive border rounded-4 border-bottom-0"},oa={class:"table m-0"},na={class:"text-nowrap text-heading"},la={class:"text-nowrap"},ia=["onUpdate:modelValue","disabled"],da={key:0,class:"switch switch-success"},ra=["checked","onChange"],ba={class:"switch-label"},ca={key:0,class:"returned-overlay"},ua={class:"table-responsive"},va={class:"table m-0 table-borderless"},ma={class:"align-top px-0 py-6"},pa={class:"mb-1"},fa={class:"text-end px-0 py-6 w-px-100"},ya={class:"fw-medium mb-1"},ha={class:"fw-medium mb-1"},ga={class:"fw-medium mb-1 border-bottom pb-2"},_a={class:"fw-medium mb-0 pt-2"},xa={class:"card-body p-0"},wa={class:"row"},Pa={class:"col-12"},Da={key:2,class:"text-center"},Sa={__name:"sales-order-detail",setup(ka){const c=B(),x=k(),b=j(),{salesOrder:e,loading:u}=S(c),v=x.query.id,m=l=>l.salesReturnItems?l.salesReturnItems.some(t=>t.salesReturn&&t.salesReturn.status==="approved"):!1;async function p(){const l=Array.isArray(v)?v[0]:v;if(typeof l=="string"){u.value=!0;try{await c.getSalesOrderDetails(l)}catch(t){console.error("Failed to refresh SO details:",t)}finally{u.value=!1}}}async function w(l,t,n){const r=e.value.salesOrderItems.find(f=>f.id===l);if(!r){console.error("Item not found!");return}if(n>r.quantity){_.fire({icon:"error",title:"Validasi Gagal",text:"Quantity yang diterima tidak boleh melebihi quantity yang dipesan!"}),await p();return}try{await c.updateStatusPartial(l,t,n),await p()}catch(f){console.error("Failed to update status:",f),_.fire({icon:"error",title:"Update Gagal",text:"Terjadi kesalahan saat memperbarui status item."})}}const P=I(()=>{if(e.value&&e.value.salesOrderItems){const l=e.value.salesOrderItems.reduce((n,r)=>n+Number(r.subtotal),0),t=l*(Number(e.value.discountPercent)/100);return l-t}return 0});return C(p),(l,t)=>(d(),i("div",N,[a("div",F,[s(u)?(d(),i("div",Q,t[0]||(t[0]=[a("div",{class:"spinner-border",role:"status"},[a("span",{class:"visually-hidden"},"Loading...")],-1)]))):s(e)?(d(),i(h,{key:1},[a("div",V,[a("div",q,[a("div",E,[a("div",L,[a("div",M,[a("div",null,[t[1]||(t[1]=a("div",{class:"d-flex svg-illustration align-items-center gap-2 mb-6"},[a("span",{class:"app-brand-logo demo"},[a("span",{style:{color:"var(--bs-primary)"}},[a("img",{src:R,alt:"logo",width:"200"})])])],-1)),a("p",U,o(s(e).perusahaan.alamatPerusahaan),1),a("p",$,o(s(e).perusahaan.kodePerusahaan),1),a("p",G,o(s(e).perusahaan.npwpPerusahaan),1)]),a("div",null,[a("h5",W,"Sales Number : "+o(s(e).noSo),1),a("div",X,[t[2]||(t[2]=a("span",null,"Date Issues: ",-1)),a("span",null,o(new Date(s(e).date).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})),1)]),a("div",null,[t[3]||(t[3]=a("span",null,"Date Due: ",-1)),a("span",null,o(new Date(s(e).dueDate).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})),1)])])])]),a("div",z,[a("div",H,[a("div",null,[t[4]||(t[4]=a("h6",null,"Invoice To:",-1)),a("p",J,o(s(e).up),1),a("p",K,o(s(e).customer.name),1),a("p",Y,o(s(e).customer.address),1),a("p",Z,o(s(e).customer.phone),1),a("p",aa,o(s(e).customer.email),1)]),a("div",null,[t[5]||(t[5]=a("h6",null,"Bill To:",-1)),a("p",ta,o(s(e).perusahaan.nmPerusahaan),1),a("p",ea,o(s(e).perusahaan.alamatPerusahaan),1)])])]),a("div",sa,[a("table",oa,[t[7]||(t[7]=a("thead",null,[a("tr",null,[a("th",null,"Item"),a("th",null,"Description"),a("th",null,"Cost"),a("th",null,"Qty"),a("th",null,"Delivered Qty"),a("th",null,"Total Price"),a("th",null,"Status")])],-1)),a("tbody",null,[(d(!0),i(h,null,O(s(e).salesOrderItems,n=>(d(),i("tr",{key:n.id,class:"position-relative"},[a("td",na,o(n.product.name),1),a("td",la,o(n.description),1),a("td",null,o(s(b)(n.price)),1),a("td",null,o(n.quantity),1),a("td",null,[T(a("input",{type:"number",class:"form-control","onUpdate:modelValue":r=>n.deliveredQty=r,style:{width:"80px"},disabled:n.statusPartial||m(n)},null,8,ia),[[A,n.deliveredQty]])]),a("td",null,o(s(b)(n.subtotal)),1),a("td",null,[m(n)?g("",!0):(d(),i("label",da,[a("input",{type:"checkbox",class:"switch-input",checked:n.statusPartial,onChange:r=>w(n.id,!n.statusPartial,n.deliveredQty)},null,40,ra),t[6]||(t[6]=y('<span class="switch-toggle-slider" data-v-b000be07><span class="switch-on" data-v-b000be07><i class="ri-check-line" data-v-b000be07></i></span><span class="switch-off" data-v-b000be07><i class="ri-close-line" data-v-b000be07></i></span></span>',1)),a("span",ba,o(n.statusPartial?"Done":"Pending"),1)]))]),m(n)?(d(),i("div",ca," RETURNED ")):g("",!0)]))),128))])])]),a("div",ua,[a("table",va,[a("tbody",null,[a("tr",null,[a("td",ma,[a("p",pa,[t[8]||(t[8]=a("span",{class:"me-2 fw-medium text-heading"},"Created by:",-1)),a("span",null,o(s(e).createdBy),1)]),t[9]||(t[9]=a("span",null,"Thanks for your business",-1))]),t[10]||(t[10]=a("td",{class:"pe-0 py-6 w-px-100"},[a("p",{class:"mb-1"},"Discount:"),a("p",{class:"mb-1"},"Subtotal:"),a("p",{class:"mb-1 border-bottom pb-2"},"Tax:"),a("p",{class:"mb-0 pt-2"},"Total:")],-1)),a("td",fa,[a("p",ya,o(s(e).discountPercent)+"%",1),a("p",ha,o(s(b)(P.value)),1),a("p",ga,o(s(e).taxPercent)+"%",1),a("p",_a,o(s(b)(s(e).total)),1)])])])])]),t[12]||(t[12]=a("hr",{class:"mt-0 mb-6"},null,-1)),a("div",xa,[a("div",wa,[a("div",Pa,[t[11]||(t[11]=a("span",{class:"fw-medium text-heading"},"Note: ",-1)),a("span",null,o(s(e).description),1)])])])])]),t[13]||(t[13]=y('<div class="col-xl-3 col-md-4 col-12 invoice-actions" data-v-b000be07><div class="card" data-v-b000be07><div class="card-body" data-v-b000be07><button class="btn btn-primary d-grid w-100 mb-4" data-bs-toggle="offcanvas" data-bs-target="#sendInvoiceOffcanvas" data-v-b000be07><span class="d-flex align-items-center justify-content-center text-nowrap" data-v-b000be07><i class="ri-send-plane-line ri-16px scaleX-n1-rtl me-2" data-v-b000be07></i>Send Invoice</span></button><button class="btn btn-outline-secondary d-grid w-100 mb-4" data-v-b000be07>Download</button><div class="d-flex mb-4" data-v-b000be07><a class="btn btn-outline-secondary d-grid w-100 me-4" target="_blank" href="./app-invoice-print.html" data-v-b000be07> Print </a><a href="./app-invoice-edit.html" class="btn btn-outline-secondary d-grid w-100" data-v-b000be07> Edit </a></div><button class="btn btn-success d-grid w-100" data-bs-toggle="offcanvas" data-bs-target="#addPaymentOffcanvas" data-v-b000be07><span class="d-flex align-items-center justify-content-center text-nowrap" data-v-b000be07><i class="ri-money-dollar-circle-line ri-16px me-2" data-v-b000be07></i>Add Payment</span></button></div></div></div>',1))]),t[14]||(t[14]=y(`<div class="offcanvas offcanvas-end" id="sendInvoiceOffcanvas" aria-hidden="true" data-v-b000be07><div class="offcanvas-header border-bottom" data-v-b000be07><h5 class="offcanvas-title" data-v-b000be07>Send Invoice</h5><button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close" data-v-b000be07></button></div><div class="offcanvas-body flex-grow-1" data-v-b000be07><form data-v-b000be07><div class="form-floating form-floating-outline mb-5" data-v-b000be07><input type="text" class="form-control" id="invoice-from" value="shelbyComapny@email.com" placeholder="company@email.com" data-v-b000be07><label for="invoice-from" data-v-b000be07>From</label></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><input type="text" class="form-control" id="invoice-to" value="qConsolidated@email.com" placeholder="company@email.com" data-v-b000be07><label for="invoice-to" data-v-b000be07>To</label></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><input type="text" class="form-control" id="invoice-subject" value="Invoice of purchased Admin Templates" placeholder="Invoice regarding goods" data-v-b000be07><label for="invoice-subject" data-v-b000be07>Subject</label></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><textarea class="form-control" name="invoice-message" id="invoice-message" style="height:190px;" data-v-b000be07>    Dear Queen Consolidated,\r
            Thank you for your business, always a pleasure to work with you!\r
            We have generated a new invoice in the amount of $95.59\r
            We would appreciate payment of this invoice by 05/11/2021</textarea><label for="invoice-message" data-v-b000be07>Message</label></div><div class="mb-5" data-v-b000be07><span class="badge bg-label-primary rounded-pill" data-v-b000be07><i class="ri-links-line ri-14px me-1" data-v-b000be07></i><span class="align-middle" data-v-b000be07>Invoice Attached</span></span></div><div class="mb-4 d-flex flex-wrap" data-v-b000be07><button type="button" class="btn btn-primary me-4" data-bs-dismiss="offcanvas" data-v-b000be07>Send</button><button type="button" class="btn btn-outline-secondary" data-bs-dismiss="offcanvas" data-v-b000be07> Cancel </button></div></form></div></div><div class="offcanvas offcanvas-end" id="addPaymentOffcanvas" aria-hidden="true" data-v-b000be07><div class="offcanvas-header border-bottom" data-v-b000be07><h5 class="offcanvas-title" data-v-b000be07>Add Payment</h5><button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close" data-v-b000be07></button></div><div class="offcanvas-body flex-grow-1" data-v-b000be07><div class="d-flex justify-content-between bg-lighter p-2 mb-5" data-v-b000be07><p class="mb-0" data-v-b000be07>Invoice Balance:</p><p class="fw-medium mb-0" data-v-b000be07>$5000.00</p></div><form data-v-b000be07><div class="input-group input-group-merge mb-5" data-v-b000be07><span class="input-group-text" data-v-b000be07>$</span><div class="form-floating form-floating-outline" data-v-b000be07><input type="text" id="invoiceAmount" name="invoiceAmount" class="form-control invoice-amount" placeholder="100" data-v-b000be07><label for="invoiceAmount" data-v-b000be07>Payment Amount</label></div></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><input id="payment-date" class="form-control invoice-date" type="text" data-v-b000be07><label for="payment-date" data-v-b000be07>Payment Date</label></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><select class="form-select" id="payment-method" data-v-b000be07><option value="" selected disabled data-v-b000be07>Select payment method</option><option value="Cash" data-v-b000be07>Cash</option><option value="Bank Transfer" data-v-b000be07>Bank Transfer</option><option value="Debit Card" data-v-b000be07>Debit Card</option><option value="Credit Card" data-v-b000be07>Credit Card</option><option value="Paypal" data-v-b000be07>Paypal</option></select><label for="payment-method" data-v-b000be07>Payment Method</label></div><div class="form-floating form-floating-outline mb-5" data-v-b000be07><textarea class="form-control" id="payment-note" style="height:62px;" data-v-b000be07></textarea><label for="payment-note" data-v-b000be07>Internal Payment Note</label></div><div class="d-flex flex-wrap" data-v-b000be07><button type="button" class="btn btn-primary me-4" data-bs-dismiss="offcanvas" data-v-b000be07>Send</button><button type="button" class="btn btn-outline-secondary" data-bs-dismiss="offcanvas" data-v-b000be07> Cancel </button></div></form></div></div>`,2))],64)):(d(),i("div",Da,t[15]||(t[15]=[a("p",null,"Sales Order not found.",-1)])))])]))}},Fa=D(Sa,[["__scopeId","data-v-b000be07"]]);export{Fa as default};
