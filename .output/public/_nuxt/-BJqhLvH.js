import{_ as N,f as A,j as f,s as I,k as $,l as j,K as E,g as U,c as x,a as e,m as S,n as _,i as a,b as r,d as p,w as i,r as v,o as g,t as w}from"./Bkm6qw8b.js";import{u as G}from"./u26IMBn3.js";import{u as M}from"./B1HDS-e3.js";import{_ as C}from"./CdgIhitS.js";import{_ as q}from"./DleeVanq.js";import"./D1pefl20.js";const z={class:"content-wrapper"},J={class:"container-xxl flex-grow-1 container-p-y"},W={class:"row g-6 mb-6"},H={class:"row g-6"},K={class:"col-12"},O={class:"card"},Y={class:"card-header d-flex justify-content-between align-items-center flex-wrap"},Q={class:"d-flex align-items-center me-3 mb-2 mb-md-0"},X={class:"d-flex align-items-center"},Z={class:"btn-group me-2"},tt={class:"dropdown-menu"},et={class:"input-group"},ot={class:"p-input-icon-left"},at={class:"card-datatable table-responsive py-3 px-3"},st={class:"badge bg-primary"},nt={class:"d-inline-block"},rt={class:"dropdown-menu"},lt={key:0},it=["onClick"],dt={__name:"stock",setup(ct){const{$api:ut}=A(),b=f(null),T=G(),n=M(),{stocks:P,totalRecords:B,stats:m,params:l}=I(n),V=f(!1),k=f(""),D=$(()=>{var s,t;return((t=(s=T.user)==null?void 0:s.permissions)==null?void 0:t.some(c=>c.name==="delete stock"))??!1}),L=f([10,25,50,100]);let d=null;j(k,s=>{d&&clearTimeout(d),d=setTimeout(()=>{n.setSearch(s)},500)}),E(()=>{d&&clearTimeout(d)});const h=async()=>{try{await n.fetchStocksPaginated()}catch(s){const t=s.message;Swal.fire("Error",`Tidak dapat memuat data stock: ${t}`,"error")}};U(()=>{h(),n.fetchStats()});const y=s=>{s==="csv"?b.value.exportCSV():s==="pdf"&&b.value.exportPDF()},R=async s=>{if(!s)return;if((await Swal.fire({title:"Apakah Anda yakin?",text:"Tindakan ini tidak bisa dibatalkan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#666CFF",cancelButtonColor:"#A7A9B3",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed)try{await n.deleteStockIn(s),h(),await Swal.fire({title:"Berhasil!",text:"Stock In berhasil dihapus.",icon:"success"})}catch(c){await Swal.fire({title:"Error",text:c.message,icon:"error"})}};return(s,t)=>{const c=v("Dropdown"),F=v("InputText"),u=v("Column");return g(),x("div",z,[e("div",J,[t[11]||(t[11]=e("h4",{class:"mb-1"},"List Stock",-1)),t[12]||(t[12]=e("p",{class:"mb-6"}," List stock yang terdaftar di sistem ",-1)),e("div",W,[a(m).total!==void 0?(g(),S(C,{key:0,title:"Total Stock",total:a(m).total+" Stock"},null,8,["total"])):_("",!0),a(m).perWarehouse.length>0?(g(),S(C,{key:1,title:"Total Stock Per Gudang",total:a(m).perWarehouse.length+" Gudang"},null,8,["total"])):_("",!0)]),e("div",H,[t[10]||(t[10]=e("div",{class:"col-12"},[e("h4",{class:"mt-6 mb-1"},"Total Stock"),e("p",{class:"mb-0"},"Find all of your company's administrator accounts and their associate Stock.")],-1)),e("div",K,[e("div",O,[e("div",Y,[e("div",Q,[t[6]||(t[6]=e("span",{class:"me-2"},"Baris:",-1)),r(c,{modelValue:a(l).rows,"onUpdate:modelValue":t[0]||(t[0]=o=>a(l).rows=o),options:L.value,onChange:a(n).handleRowsChange,placeholder:"Jumlah",style:{width:"8rem"}},null,8,["modelValue","options","onChange"])]),e("div",X,[e("div",Z,[t[7]||(t[7]=e("button",{class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"ri-upload-2-line me-1"}),p(" Export ")],-1)),e("ul",tt,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:t[1]||(t[1]=o=>y("csv"))},"CSV")]),e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:t[2]||(t[2]=o=>y("pdf"))},"PDF")])])]),e("div",et,[e("span",ot,[r(F,{modelValue:k.value,"onUpdate:modelValue":t[3]||(t[3]=o=>k.value=o),placeholder:"Cari Stock In...",class:"w-full md:w-20rem"},null,8,["modelValue"])])])])]),e("div",at,[r(q,{ref_key:"myDataTableRef",ref:b,data:a(P),rows:a(l).rows,loading:V.value,totalRecords:a(B),lazy:!0,onPage:t[4]||(t[4]=o=>a(n).setPagination(o)),onSort:t[5]||(t[5]=o=>a(n).setSort(o)),responsiveLayout:"scroll",paginatorPosition:"bottom",paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",currentPageReportTemplate:"Menampilkan {first} sampai {last} dari {totalRecords} data"},{default:i(()=>[r(u,{header:"#",sortable:!1},{body:i(o=>[p(w(Number.isFinite(a(l).page)&&Number.isFinite(a(l).rows)?(a(l).page-1)*a(l).rows+o.index+1:o.index+1),1)]),_:1}),r(u,{field:"product.name",header:"Nama Produk",sortable:!0},{body:i(o=>[p(w(o.data.product.name),1)]),_:1}),r(u,{field:"warehouse.name",header:"Gudang",sortable:!0,class:"text-nowrap"},{body:i(o=>[e("span",st,w(o.data.warehouse.name),1)]),_:1}),r(u,{field:"quantity",header:"Jumlah",sortable:!0,class:"text-nowrap"},{body:i(o=>[p(w(Math.floor(o.data.quantity)),1)]),_:1}),r(u,{header:"Actions",exportable:!1,style:{"min-width":"8rem"}},{body:i(o=>[e("div",nt,[t[9]||(t[9]=e("a",{href:"javascript:;",class:"btn btn-sm btn-text-secondary rounded-pill btn-icon dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[e("i",{class:"ri-more-2-fill"})],-1)),e("ul",rt,[D.value?(g(),x("li",lt,[e("a",{class:"dropdown-item text-danger",href:"javascript:void(0)",onClick:pt=>R(o.data.id)},t[8]||(t[8]=[e("i",{class:"ri-delete-bin-7-line me-2"},null,-1),p(" Hapus ")]),8,it)])):_("",!0)])])]),_:1})]),_:1},8,["data","rows","loading","totalRecords"])])])])])]),t[13]||(t[13]=e("div",{class:"content-backdrop fade"},null,-1))])}}},_t=N(dt,[["__scopeId","data-v-69cbd4a2"]]);export{_t as default};
