import{e as u,f as n}from"./Bkm6qw8b.js";import{S as i}from"./9Qm2jZ7z.js";const d=u("menu-group",{state:()=>({menuGroups:[],sidebarMenuGroups:[],loading:!0,error:null,totalRecords:0,params:{first:0,rows:10,sortField:"id",sortOrder:1,search:""},form:{},isEditMode:!1,showModal:!1,validationErrors:[]}),actions:{async fetchMenuGroups(){var a;this.loading=!0,this.error=null;const{$api:r}=n();try{const s=new URLSearchParams({page:(this.params.first/this.params.rows+1).toString(),rows:this.params.rows.toString(),sortField:this.params.sortField||"id",sortOrder:(this.params.sortOrder||1)>0?"asc":"desc",search:this.params.search||"",all:"true"}),t=localStorage.getItem("token"),e=await fetch(`${r.menuGroups()}?${s.toString()}`,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json"}});if(!e.ok)throw new Error("Gagal mengambil data menu group");const o=await e.json();this.menuGroups=o.data||[],this.totalRecords=((a=o.meta)==null?void 0:a.total)||0}catch(s){this.error=s.message,i.fire("Error",`Tidak dapat memuat data menu group: ${s.message}`,"error")}finally{this.loading=!1}},async prefetchMenuGroups(){this.menuGroups.length>0&&this.params.rows===999||this.loading||await this.fetchMenuGroups()},async fetchAllMenuGroups(){this.loading=!0,this.error=null;const{$api:r}=n();try{const a=new URLSearchParams({page:"1",rows:"999"}),s=localStorage.getItem("token"),t=await fetch(`${r.menuGroups()}?${a.toString()}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}});if(!t.ok)throw new Error("Gagal mengambil semua data menu group");const e=await t.json();this.sidebarMenuGroups=e.data||[]}catch(a){this.error=a.message,console.error(`Tidak dapat memuat data menu group untuk sidebar: ${a.message}`)}finally{this.loading=!1}},async saveMenuGroup(){this.loading=!0,this.validationErrors=[];const{$api:r}=n();try{const a=localStorage.getItem("token");let s=r.menuGroups(),t="POST";const e=JSON.stringify(this.form);this.isEditMode&&this.form.id&&(s=`${r.menuGroups()}/${this.form.id}`,t="PUT");const o=await fetch(s,{method:t,headers:{Authorization:`Bearer ${a}`,Accept:"application/json","Content-Type":"application/json"},body:e,credentials:"include"});if(!o.ok){const l=await o.json();throw o.status===422?(this.validationErrors=Object.values(l.errors).flat(),new Error("Data validasi tidak valid")):new Error(l.message||"Gagal menyimpan data menu group")}this.closeModal(),await this.fetchMenuGroups(),i.fire("Berhasil!",`Menu group berhasil ${this.isEditMode?"diperbarui":"disimpan"}.`,"success")}catch(a){a.message!=="Data validasi tidak valid"&&i.fire("Error",a.message||"Operasi gagal","error")}finally{this.loading=!1}},async deleteMenuGroup(r){this.loading=!0;const{$api:a}=n();if(!(await i.fire({title:"Apakah Anda yakin?",text:"Data menu group yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"})).isConfirmed){this.loading=!1;return}try{const t=localStorage.getItem("token"),e=await fetch(`${a.menuGroups()}/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`,Accept:"application/json"},credentials:"include"});if(!e.ok){const o=await e.json();throw new Error(o.message||"Gagal menghapus menu group")}await this.fetchMenuGroups(),i.fire("Berhasil!","Menu group berhasil dihapus.","success")}catch(t){console.error("Gagal menghapus menu group:",t),i.fire("Error",t.message||"Gagal menghapus menu group","error")}finally{this.loading=!1}},openModal(r=null){this.isEditMode=!!r,this.validationErrors=[],r?this.form={...r}:this.form={name:"",icon:"",order:void 0,jenisMenu:void 0},this.showModal=!0},closeModal(){this.showModal=!1,this.isEditMode=!1,this.form={},this.validationErrors=[]},setPagination(r){this.params.first=r.first,this.params.rows=r.rows,this.fetchMenuGroups()},setSort(r){this.params.sortField=r.sortField,this.params.sortOrder=r.sortOrder,this.fetchMenuGroups()},setSearch(r){this.params.search=r,this.params.first=0,this.fetchMenuGroups()}}});export{d as u};
