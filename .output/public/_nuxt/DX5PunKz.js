import{_ as tt,u as st,j as k,s as S,k as L,g as at,l as R,c as d,a as t,b as r,h as et,i as a,d as p,w as h,o as n,q as ot,v as lt,E as m,n as w,z as P,A as v,B as g,F as it,x as rt,I as dt}from"./Bkm6qw8b.js";import{_ as nt,a as ut,b as U,c as mt,d as ct}from"./BrFEKIuM.js";import{_ as pt}from"./mvyRji1Y.js";import{_ as bt}from"./BAMzpvu1.js";import{_ as vt}from"./DleeVanq.js";import{u as gt}from"./BRMs87XN.js";import{u as ft}from"./CGIrALZn.js";import{C as _t}from"./D9zIpW-x.js";import{u as ht}from"./D29843uf.js";import{u as wt}from"./VXGyPOT6.js";import{u as yt}from"./Ca1Fz0tn.js";import{u as xt}from"./u26IMBn3.js";import{u as Ct}from"./CI-DMe-d.js";import"./9Qm2jZ7z.js";const kt={class:"content-wrapper"},St={class:"container-xxl flex-grow-1 container-p-y"},Pt={class:"row g-6 mb-6"},Vt={class:"col-xl-4 col-lg-6 col-md-6"},Mt={class:"card h-100"},jt={class:"row h-100"},Tt={class:"col-sm-7"},$t={class:"card-body text-sm-end text-center ps-sm-0"},Lt={class:"row g-6"},Rt={class:"col-12"},Ut={class:"card"},At={class:"card-header d-flex justify-content-between align-items-center flex-wrap"},Nt={class:"d-flex align-items-center me-3 mb-2 mb-md-0"},Et={class:"d-flex align-items-center"},Dt={class:"btn-group me-2"},It={class:"dropdown-menu"},Bt={class:"input-group"},qt={class:"p-input-icon-left"},Ft={class:"card-datatable table-responsive py-3 px-3"},Ht={key:0},Kt=["src"],zt={key:1},Wt={class:"d-inline-block"},Jt={class:"dropdown-menu"},Ot={key:0},Gt=["onClick"],Qt={key:1},Xt=["onClick"],Yt={key:2},Zt=["onClick"],ts={class:"row g-6"},ss={class:"col-md-6"},as={class:"form-floating form-floating-outline"},es=["required"],os={class:"col-md-6"},ls={class:"form-floating form-floating-outline"},is={class:"col-md-6"},rs={class:"form-floating form-floating-outline"},ds={class:"col-md-6"},ns={class:"form-floating form-floating-outline"},us={class:"col-md-12"},ms={class:"form-floating form-floating-outline"},cs={class:"col-md-12"},ps={class:"form-floating form-floating-outline"},bs={class:"row"},vs={class:"mb-6 col-lg-6 col-xl-6 col-12 mb-0"},gs={class:"form-floating form-floating-outline"},fs={class:"mb-3 col-lg-4 col-xl-3 col-12 mb-0"},_s={class:"form-floating form-floating-outline"},hs=["value","onInput"],ws={class:"mb-3 col-lg-2 col-xl-3 col-12 mb-0"},ys=["onClick"],xs={class:"mt-0"},Cs={class:"modal-footer mt-6"},ks=["disabled"],Ss={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ps={__name:"customer",setup(Vs){const V=dt(),A=st(),N=ht(),M=k(null),l=gt(),j=ft(),{userHasPermission:y}=yt(),T=wt(),E=xt(),{customers:D,loading:x,totalRecords:I,params:f,form:i,isEditMode:C,showModal:B,validationErrors:q}=S(l),{products:F}=S(j),{permissions:Ms}=S(T),_=k(""),H=k([10,25,50,100]),K=L(()=>C.value?"Edit Customer":"Tambah Customer"),z=L(()=>C.value?"Silakan ubah data customer di bawah ini.":"Silakan isi form di bawah ini untuk menambahkan customer baru."),W=o=>!o||typeof o!="string"?null:o.startsWith("http")||!V.public.apiBase?o:`${new URL(V.public.apiBase).origin}/${o}`;let c=null;at(()=>{T.fetchPermissions(),E.loadUser(),l.customers.length===0&&l.fetchCustomers(),j.fetchProducts();const o=document.getElementById("CustomerModal");o&&(c=new bootstrap.Modal(o))}),R(B,o=>{o?c==null||c.show():c==null||c.hide()});const J=Ct(()=>{l.setSearch(_.value)},500);R(_,J);const O=o=>l.setPagination(o),G=()=>{f.value.first=0,l.fetchCustomers()},Q=o=>l.setSort(o),$=o=>{o==="csv"&&M.value.exportCSV()};function X(o){const s=o.target.files[0];s&&l.handleLogoChange(s)}const Y=o=>{A.push({path:"/sales/customer-detail",query:{id:o}})};return(o,s)=>(n(),d("div",kt,[t("div",St,[s[39]||(s[39]=t("h4",{class:"mb-1"},"List Customer",-1)),s[40]||(s[40]=t("p",{class:"mb-6"}," List customer yang terdaftar di sistem ",-1)),t("div",Pt,[s[19]||(s[19]=et('<div class="col-xl-4 col-lg-6 col-md-6" data-v-8b31bb57><div class="card" data-v-8b31bb57><div class="card-body" data-v-8b31bb57><div class="d-flex justify-content-between align-items-center mb-4" data-v-8b31bb57><p class="mb-0" data-v-8b31bb57>Total 3 users</p><ul class="list-unstyled d-flex align-items-center avatar-group mb-0" data-v-8b31bb57><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Kim Karlos" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+nt+'" alt="Avatar" data-v-8b31bb57></li><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Katy Turner" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+ut+'" alt="Avatar" data-v-8b31bb57></li><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Peter Adward" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+U+'" alt="Avatar" data-v-8b31bb57></li><li class="avatar" data-v-8b31bb57><span class="avatar-initial rounded-circle pull-up bg-lighter text-body" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3 more" data-v-8b31bb57>+3</span></li></ul></div><div class="d-flex justify-content-between align-items-center" data-v-8b31bb57><div class="pegawai-heading" data-v-8b31bb57><h5 class="mb-1" data-v-8b31bb57>Support</h5><a href="javascript:;" data-bs-toggle="modal" data-bs-target="#PegawaiModal" class="pegawai-edit-modal" data-v-8b31bb57></a></div><a href="javascript:void(0);" class="text-secondary" data-v-8b31bb57><i class="ri-file-copy-line ri-22px" data-v-8b31bb57></i></a></div></div></div></div><div class="col-xl-4 col-lg-6 col-md-6" data-v-8b31bb57><div class="card" data-v-8b31bb57><div class="card-body" data-v-8b31bb57><div class="d-flex justify-content-between align-items-center mb-4" data-v-8b31bb57><p class="mb-0" data-v-8b31bb57>Total 2 users</p><ul class="list-unstyled d-flex align-items-center avatar-group mb-0" data-v-8b31bb57><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Kim Merchent" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+mt+'" alt="Avatar" data-v-8b31bb57></li><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Sam D&#39;souza" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+ct+'" alt="Avatar" data-v-8b31bb57></li><li data-bs-toggle="tooltip" data-popup="tooltip-custom" data-bs-placement="top" title="Nurvi Karlos" class="avatar pull-up" data-v-8b31bb57><img class="rounded-circle" src="'+U+'" alt="Avatar" data-v-8b31bb57></li><li class="avatar" data-v-8b31bb57><span class="avatar-initial rounded-circle pull-up bg-lighter text-body" data-bs-toggle="tooltip" data-bs-placement="bottom" title="3 more" data-v-8b31bb57>+3</span></li></ul></div><div class="d-flex justify-content-between align-items-center" data-v-8b31bb57><div class="pegawai-heading" data-v-8b31bb57><h5 class="mb-1" data-v-8b31bb57>Restricted User</h5><a href="javascript:;" data-bs-toggle="modal" data-bs-target="#PegawaiModal" class="pegawai-edit-modal" data-v-8b31bb57></a></div><a href="javascript:void(0);" class="text-secondary" data-v-8b31bb57><i class="ri-file-copy-line ri-22px" data-v-8b31bb57></i></a></div></div></div></div>',2)),t("div",Vt,[t("div",Mt,[t("div",jt,[s[18]||(s[18]=t("div",{class:"col-sm-5"},[t("div",{class:"d-flex align-items-end h-100 justify-content-center"},[t("img",{src:pt,class:"img-fluid",alt:"Image",width:"70"})])],-1)),t("div",Tt,[t("div",$t,[t("button",{onClick:s[0]||(s[0]=e=>a(l).openModal()),class:"btn btn-primary mb-2 text-nowrap add-new-role"}," Tambah Customer "),s[17]||(s[17]=t("p",{class:"mb-0 mt-1"},"Buat Customer baru",-1))])])])])])]),t("div",Lt,[s[27]||(s[27]=t("div",{class:"col-12"},[t("h4",{class:"mt-6 mb-1"},"Total Customer"),t("p",{class:"mb-0"},"Find all of your company's administrator accounts and their associate Customer.")],-1)),t("div",Rt,[t("div",Ut,[t("div",At,[t("div",Nt,[s[20]||(s[20]=t("span",{class:"me-2"},"Baris:",-1)),r(a(ot),{modelValue:a(f).rows,"onUpdate:modelValue":s[1]||(s[1]=e=>a(f).rows=e),options:H.value,onChange:G,placeholder:"Jumlah",style:{width:"8rem"}},null,8,["modelValue","options"])]),t("div",Et,[t("div",Dt,[s[21]||(s[21]=t("button",{class:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"ri-upload-2-line me-1"}),p(" Export ")],-1)),t("ul",It,[t("li",null,[t("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:s[2]||(s[2]=e=>$("csv"))},"CSV")]),t("li",null,[t("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:s[3]||(s[3]=e=>$("pdf"))},"PDF")])])]),t("div",Bt,[t("span",qt,[r(a(lt),{modelValue:_.value,"onUpdate:modelValue":s[4]||(s[4]=e=>_.value=e),placeholder:"Cari customer...",class:"w-full md:w-20rem"},null,8,["modelValue"])])])])]),t("div",Ft,[r(vt,{ref_key:"myDataTableRef",ref:M,data:a(D),rows:a(f).rows,loading:a(x),totalRecords:a(I),lazy:!0,onPage:s[5]||(s[5]=e=>O(e)),onSort:s[6]||(s[6]=e=>Q(e)),paginatorTemplate:"CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink",currentPageReportTemplate:"Menampilkan {first} sampai {last} dari {totalRecords} data"},{default:h(()=>[r(a(m),{field:"id",header:"#",sortable:!0}),r(a(m),{field:"logo",header:"Logo",sortable:!0},{body:h(e=>[e.data.logo?(n(),d("div",Ht,[t("img",{src:W(e.data.logo),alt:"Logo",style:{height:"40px","max-width":"80px","object-fit":"contain"}},null,8,Kt)])):(n(),d("div",zt,s[22]||(s[22]=[t("span",{class:"text-muted"},"Tidak ada logo",-1)])))]),_:1}),r(a(m),{field:"name",header:"Nama Customer",sortable:!0}),r(a(m),{field:"address",header:"Alamat Customer",sortable:!0}),r(a(m),{field:"npwp",header:"NPWP Customer",sortable:!0}),r(a(m),{field:"email",header:"Email Customer",sortable:!0}),r(a(m),{field:"phone",header:"Phone Customer",sortable:!0}),r(a(m),{header:"Actions",exportable:!1,style:{"min-width":"8rem"}},{body:h(e=>[t("div",Wt,[s[26]||(s[26]=t("a",{href:"javascript:;",class:"btn btn-sm btn-text-secondary rounded-pill btn-icon dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[t("i",{class:"ri-more-2-fill"})],-1)),t("ul",Jt,[a(y)("show_customer")?(n(),d("li",Ot,[t("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:b=>Y(e.data.id)},s[23]||(s[23]=[t("i",{class:"ri-eye-line me-2"},null,-1),p(" Lihat Detail ")]),8,Gt)])):w("",!0),a(y)("edit_customer")?(n(),d("li",Qt,[t("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:b=>a(l).openModal(e.data)},s[24]||(s[24]=[t("i",{class:"ri-edit-box-line me-2"},null,-1),p(" Edit ")]),8,Xt)])):w("",!0),a(y)("delete_customer")?(n(),d("li",Yt,[t("a",{class:"dropdown-item text-danger",href:"javascript:void(0)",onClick:b=>a(l).deleteCustomer(e.data.id)},s[25]||(s[25]=[t("i",{class:"ri-delete-bin-7-line me-2"},null,-1),p(" Hapus ")]),8,Zt)])):w("",!0)])])]),_:1})]),_:1},8,["data","rows","loading","totalRecords"])])])])]),r(bt,{id:"CustomerModal",title:K.value,description:z.value,"validation-errors-from-parent":a(q)},{default:h(()=>[t("form",{onSubmit:s[16]||(s[16]=P(e=>a(l).saveCustomer(),["prevent"]))},[t("div",ts,[t("div",ss,[t("div",as,[t("input",{type:"file",class:"form-control",onChange:X,placeholder:"Masukkan logo customer",required:!a(C)},null,40,es),s[28]||(s[28]=t("label",null,"Logo Customer",-1))])]),t("div",os,[t("div",ls,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[7]||(s[7]=e=>a(i).name=e),placeholder:"Masukkan nama customer",required:""},null,512),[[g,a(i).name]]),s[29]||(s[29]=t("label",null,"Nama Customer",-1))])]),t("div",is,[t("div",rs,[v(t("input",{type:"email",class:"form-control","onUpdate:modelValue":s[8]||(s[8]=e=>a(i).email=e),placeholder:"Masukkan email customer",required:""},null,512),[[g,a(i).email]]),s[30]||(s[30]=t("label",null,"Email Customer",-1))])]),t("div",ds,[t("div",ns,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[9]||(s[9]=e=>a(i).phone=e),placeholder:"Masukkan no. telp customer",onInput:s[10]||(s[10]=e=>a(i).phone=e.target.value.replace(/[^0-9]/g,"")),inputmode:"numeric",pattern:"[0-9]*",required:""},null,544),[[g,a(i).phone]]),s[31]||(s[31]=t("label",null,"No. Telp Customer",-1))])]),t("div",us,[t("div",ms,[v(t("input",{type:"text",class:"form-control","onUpdate:modelValue":s[11]||(s[11]=e=>a(i).npwp=e),placeholder:"Masukkan npwp customer",onInput:s[12]||(s[12]=e=>a(i).npwp=e.target.value.replace(/[^0-9]/g,"")),inputmode:"numeric",pattern:"[0-9]*",required:""},null,544),[[g,a(i).npwp]]),s[32]||(s[32]=t("label",null,"NPWP Customer",-1))])]),t("div",cs,[t("div",ps,[v(t("textarea",{class:"form-control h-px-100",placeholder:"Alamat Customer","onUpdate:modelValue":s[13]||(s[13]=e=>a(i).address=e)},"                                    ",512),[[g,a(i).address]]),s[33]||(s[33]=t("label",null,"Alamat Customer",-1))])]),s[38]||(s[38]=t("hr",{class:"mt-7 w-70 justify-content-center"},null,-1)),(n(!0),d(it,null,rt(a(i).customerProducts,(e,b)=>(n(),d("div",{key:b,class:"repeater-item"},[t("div",bs,[t("div",vs,[t("div",gs,[r(a(_t),{modelValue:e.productId,"onUpdate:modelValue":u=>e.productId=u,options:a(F),"get-option-label":u=>`${u.name}`,reduce:u=>u.id,placeholder:"-- Pilih Produk --",class:"product-select"},null,8,["modelValue","onUpdate:modelValue","options","get-option-label","reduce"])])]),t("div",fs,[t("div",_s,[t("input",{type:"text",class:"form-control",placeholder:"Harga",value:a(N)(e.priceSell),onInput:u=>{const Z=u.target.value.replace(/[^0-9]/g,"");e.priceSell=Z}},null,40,hs),s[34]||(s[34]=t("label",null,"Harga Jual",-1))])]),t("div",ws,[t("button",{type:"button",class:"btn btn-sm btn-secondary",onClick:P(u=>a(l).removeItem(b),["prevent"]),style:{width:"100%"}},s[35]||(s[35]=[t("span",{class:"tf-icons ri-delete-bin-7-line ri-16px me-2"},null,-1),p(" Hapus ")]),8,ys)])])]))),128)),t("div",xs,[t("button",{class:"btn btn-sm btn-primary",onClick:s[14]||(s[14]=P(e=>a(l).addItem(),["prevent"]))},s[36]||(s[36]=[t("i",{class:"ri-add-line me-1"},null,-1),t("span",{class:"align-middle"},"Tambah Item",-1)]))]),t("div",Cs,[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:s[15]||(s[15]=e=>a(l).closeModal())},"Tutup"),t("button",{type:"submit",class:"btn btn-primary",disabled:a(x)},[a(x)?(n(),d("span",Ss)):w("",!0),s[37]||(s[37]=p(" Simpan "))],8,ks)])])],32)]),_:1},8,["title","description","validation-errors-from-parent"])]),s[41]||(s[41]=t("div",{class:"content-backdrop fade"},null,-1))]))}},Hs=tt(Ps,[["__scopeId","data-v-8b31bb57"]]);export{Hs as default};
